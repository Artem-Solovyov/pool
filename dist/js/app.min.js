(()=>{"use strict";const e={};let t={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return t.Android()||t.BlackBerry()||t.iOS()||t.Opera()||t.Windows()}};let s=!0,i=(e=500)=>{let t=document.querySelector("body");if(s){let i=document.querySelectorAll("[data-lp]");setTimeout((()=>{for(let e=0;e<i.length;e++){i[e].style.paddingRight="0px"}t.style.paddingRight="0px",document.documentElement.classList.remove("lock")}),e),s=!1,setTimeout((function(){s=!0}),e)}},n=(e=500)=>{let t=document.querySelector("body");if(s){let i=document.querySelectorAll("[data-lp]");for(let e=0;e<i.length;e++){i[e].style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px"}t.style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px",document.documentElement.classList.add("lock"),s=!1,setTimeout((function(){s=!0}),e)}};function o(e){setTimeout((()=>{window.FLS&&console.log(e)}),0)}function a(e){return e.filter((function(e,t,s){return s.indexOf(e)===t}))}e.popup=new class{constructor(e){let t={logging:!0,init:!0,attributeOpenButton:"data-popup",attributeCloseButton:"data-close",fixElementSelector:"[data-lp]",youtubeAttribute:"data-popup-youtube",youtubePlaceAttribute:"data-popup-youtube-place",setAutoplayYoutube:!0,classes:{popup:"popup",popupContent:"popup__content",popupActive:"popup_show",bodyActive:"popup-show"},focusCatch:!0,closeEsc:!0,bodyLock:!0,hashSettings:{location:!0,goHash:!0},on:{beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}}};this.youTubeCode,this.isOpen=!1,this.targetOpen={selector:!1,element:!1},this.previousOpen={selector:!1,element:!1},this.lastClosed={selector:!1,element:!1},this._dataValue=!1,this.hash=!1,this._reopen=!1,this._selectorOpen=!1,this.lastFocusEl=!1,this._focusEl=["a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"button:not([disabled]):not([aria-hidden])","select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","area[href]","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.options={...t,...e,classes:{...t.classes,...e?.classes},hashSettings:{...t.hashSettings,...e?.hashSettings},on:{...t.on,...e?.on}},this.bodyLock=!1,this.options.init&&this.initPopups()}initPopups(){this.popupLogging("Проснулся"),this.eventsPopup()}eventsPopup(){document.addEventListener("click",function(e){const t=e.target.closest(`[${this.options.attributeOpenButton}]`);if(t)return e.preventDefault(),this._dataValue=t.getAttribute(this.options.attributeOpenButton)?t.getAttribute(this.options.attributeOpenButton):"error",this.youTubeCode=t.getAttribute(this.options.youtubeAttribute)?t.getAttribute(this.options.youtubeAttribute):null,"error"!==this._dataValue?(this.isOpen||(this.lastFocusEl=t),this.targetOpen.selector=`${this._dataValue}`,this._selectorOpen=!0,void this.open()):void this.popupLogging(`Ой ой, не заполнен атрибут у ${t.classList}`);return e.target.closest(`[${this.options.attributeCloseButton}]`)||!e.target.closest(`.${this.options.classes.popupContent}`)&&this.isOpen?(e.preventDefault(),void this.close()):void 0}.bind(this)),document.addEventListener("keydown",function(e){if(this.options.closeEsc&&27==e.which&&"Escape"===e.code&&this.isOpen)return e.preventDefault(),void this.close();this.options.focusCatch&&9==e.which&&this.isOpen&&this._focusCatch(e)}.bind(this)),this.options.hashSettings.goHash&&(window.addEventListener("hashchange",function(){window.location.hash?this._openToHash():this.close(this.targetOpen.selector)}.bind(this)),window.addEventListener("load",function(){window.location.hash&&this._openToHash()}.bind(this)))}open(e){if(s)if(this.bodyLock=!(!document.documentElement.classList.contains("lock")||this.isOpen),e&&"string"==typeof e&&""!==e.trim()&&(this.targetOpen.selector=e,this._selectorOpen=!0),this.isOpen&&(this._reopen=!0,this.close()),this._selectorOpen||(this.targetOpen.selector=this.lastClosed.selector),this._reopen||(this.previousActiveElement=document.activeElement),this.targetOpen.element=document.querySelector(this.targetOpen.selector),this.targetOpen.element){if(this.youTubeCode){const e=`https://www.youtube.com/embed/${this.youTubeCode}?rel=0&showinfo=0&autoplay=1`,t=document.createElement("iframe");t.setAttribute("allowfullscreen","");const s=this.options.setAutoplayYoutube?"autoplay;":"";if(t.setAttribute("allow",`${s}; encrypted-media`),t.setAttribute("src",e),!this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)){this.targetOpen.element.querySelector(".popup__text").setAttribute(`${this.options.youtubePlaceAttribute}`,"")}this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).appendChild(t)}this.options.hashSettings.location&&(this._getHash(),this._setHash()),this.options.on.beforeOpen(this),document.dispatchEvent(new CustomEvent("beforePopupOpen",{detail:{popup:this}})),this.targetOpen.element.classList.add(this.options.classes.popupActive),document.documentElement.classList.add(this.options.classes.bodyActive),this._reopen?this._reopen=!1:!this.bodyLock&&n(),this.targetOpen.element.setAttribute("aria-hidden","false"),this.previousOpen.selector=this.targetOpen.selector,this.previousOpen.element=this.targetOpen.element,this._selectorOpen=!1,this.isOpen=!0,setTimeout((()=>{this._focusTrap()}),50),this.options.on.afterOpen(this),document.dispatchEvent(new CustomEvent("afterPopupOpen",{detail:{popup:this}})),this.popupLogging("Открыл попап")}else this.popupLogging("Ой ой, такого попапа нет.Проверьте корректность ввода. ")}close(e){e&&"string"==typeof e&&""!==e.trim()&&(this.previousOpen.selector=e),this.isOpen&&s&&(this.options.on.beforeClose(this),document.dispatchEvent(new CustomEvent("beforePopupClose",{detail:{popup:this}})),this.youTubeCode&&this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&(this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).innerHTML=""),this.previousOpen.element.classList.remove(this.options.classes.popupActive),this.previousOpen.element.setAttribute("aria-hidden","true"),this._reopen||(document.documentElement.classList.remove(this.options.classes.bodyActive),!this.bodyLock&&i(),this.isOpen=!1),this._removeHash(),this._selectorOpen&&(this.lastClosed.selector=this.previousOpen.selector,this.lastClosed.element=this.previousOpen.element),this.options.on.afterClose(this),document.dispatchEvent(new CustomEvent("afterPopupClose",{detail:{popup:this}})),setTimeout((()=>{this._focusTrap()}),50),this.popupLogging("Закрыл попап"))}_getHash(){this.options.hashSettings.location&&(this.hash=this.targetOpen.selector.includes("#")?this.targetOpen.selector:this.targetOpen.selector.replace(".","#"))}_openToHash(){let e=document.querySelector(`.${window.location.hash.replace("#","")}`)?`.${window.location.hash.replace("#","")}`:document.querySelector(`${window.location.hash}`)?`${window.location.hash}`:null;(document.querySelector(`[${this.options.attributeOpenButton} = "${e}"]`)?document.querySelector(`[${this.options.attributeOpenButton} = "${e}"]`):document.querySelector(`[${this.options.attributeOpenButton} = "${e.replace(".","#")}"]`))&&e&&this.open(e)}_setHash(){history.pushState("","",this.hash)}_removeHash(){history.pushState("","",window.location.href.split("#")[0])}_focusCatch(e){const t=this.targetOpen.element.querySelectorAll(this._focusEl),s=Array.prototype.slice.call(t),i=s.indexOf(document.activeElement);e.shiftKey&&0===i&&(s[s.length-1].focus(),e.preventDefault()),e.shiftKey||i!==s.length-1||(s[0].focus(),e.preventDefault())}_focusTrap(){const e=this.previousOpen.element.querySelectorAll(this._focusEl);!this.isOpen&&this.lastFocusEl?this.lastFocusEl.focus():e[0].focus()}popupLogging(e){this.options.logging&&o(`[Попапос]: ${e}`)}}({});e.watcher=new class{constructor(e){this.config=Object.assign({logging:!0},e),this.observer,!document.documentElement.classList.contains("watcher")&&this.scrollWatcherRun()}scrollWatcherUpdate(){this.scrollWatcherRun()}scrollWatcherRun(){document.documentElement.classList.add("watcher"),this.scrollWatcherConstructor(document.querySelectorAll("[data-watch]"))}scrollWatcherConstructor(e){if(e.length){this.scrollWatcherLogging(`Проснулся, слежу за объектами (${e.length})...`),a(Array.from(e).map((function(e){return`${e.dataset.watchRoot?e.dataset.watchRoot:null}|${e.dataset.watchMargin?e.dataset.watchMargin:"0px"}|${e.dataset.watchThreshold?e.dataset.watchThreshold:0}`}))).forEach((t=>{let s=t.split("|"),i={root:s[0],margin:s[1],threshold:s[2]},n=Array.from(e).filter((function(e){let t=e.dataset.watchRoot?e.dataset.watchRoot:null,s=e.dataset.watchMargin?e.dataset.watchMargin:"0px",n=e.dataset.watchThreshold?e.dataset.watchThreshold:0;if(String(t)===i.root&&String(s)===i.margin&&String(n)===i.threshold)return e})),o=this.getScrollWatcherConfig(i);this.scrollWatcherInit(n,o)}))}else this.scrollWatcherLogging("Сплю, нет объектов для слежения. ZzzZZzz")}getScrollWatcherConfig(e){let t={};if(document.querySelector(e.root)?t.root=document.querySelector(e.root):"null"!==e.root&&this.scrollWatcherLogging(`Эмм... родительского объекта ${e.root} нет на странице`),t.rootMargin=e.margin,!(e.margin.indexOf("px")<0&&e.margin.indexOf("%")<0)){if("prx"===e.threshold){e.threshold=[];for(let t=0;t<=1;t+=.005)e.threshold.push(t)}else e.threshold=e.threshold.split(",");return t.threshold=e.threshold,t}this.scrollWatcherLogging("Ой ой, настройку data-watch-margin нужно задавать в PX или %")}scrollWatcherCreate(e){this.observer=new IntersectionObserver(((e,t)=>{e.forEach((e=>{this.scrollWatcherCallback(e,t)}))}),e)}scrollWatcherInit(e,t){this.scrollWatcherCreate(t),e.forEach((e=>this.observer.observe(e)))}scrollWatcherIntersecting(e,t){e.isIntersecting?(!t.classList.contains("_watcher-view")&&t.classList.add("_watcher-view"),this.scrollWatcherLogging(`Я вижу ${t.classList}, добавил класс _watcher-view`)):(t.classList.contains("_watcher-view")&&t.classList.remove("_watcher-view"),this.scrollWatcherLogging(`Я не вижу ${t.classList}, убрал класс _watcher-view`))}scrollWatcherOff(e,t){t.unobserve(e),this.scrollWatcherLogging(`Я перестал следить за ${e.classList}`)}scrollWatcherLogging(e){this.config.logging&&o(`[Наблюдатель]: ${e}`)}scrollWatcherCallback(e,t){const s=e.target;this.scrollWatcherIntersecting(e,s),s.hasAttribute("data-watch-once")&&e.isIntersecting&&this.scrollWatcherOff(s,t),document.dispatchEvent(new CustomEvent("watcherCallback",{detail:{entry:e}}))}}({});let r=!1;setTimeout((()=>{if(r){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0);const l=document.getElementById("jump");function u(){(new TimelineMax).staggerFromTo(".title span",.5,{ease:Back.easeOut.config(1.7),opacity:0,bottom:-80},{ease:Back.easeOut.config(1.7),opacity:1,bottom:0},.05)}if($(document).ready((function(){$(".title").lettering()})),l.addEventListener("click",(()=>{document.documentElement.classList.add("jump"),setTimeout((()=>{u()}),1e3)})),window.onload=()=>{(window.innerWidth<1280||document.documentElement.classList.contains("touch"))&&setTimeout((()=>{u()}),500)},window.innerWidth>1279&&!t.any()){class e{constructor({callback:e=null,curtains:t=null,container:s=null,viscosity:i=2,speed:n=3.5,size:o=1,gui:a=null,guiParams:r=null}={}){t&&(this.curtains=t,this.params={container:this.curtains.container,callback:e,viscosity:i,speed:n,size:o,gui:a,guiParams:r},this.mouse={current:{x:0,y:0},last:{x:0,y:0},velocity:{x:0,y:0}},this.debug(),this.init())}debug(){this.params.gui&&this.params.guiParams&&(this.params.guiParams.viscosity=this.params.viscosity,this.params.guiParams.speed=this.params.speed,this.params.guiParams.size=this.params.size,this.ripplesGui=this.params.gui.addFolder("Render targets"),this.ripplesGui.open(),this.guiViscosity=this.ripplesGui.add(this.params.guiParams,"viscosity",1,15),this.guiSpeed=this.ripplesGui.add(this.params.guiParams,"speed",1,15),this.guiSize=this.ripplesGui.add(this.params.guiParams,"size",.5,2.5).step(.025),this.guiViscosity.onChange((e=>{this.ripples&&(this.ripples.uniforms.viscosity.value=e)})),this.guiSpeed.onChange((e=>{this.ripples&&(this.ripples.uniforms.speed.value=e)})),this.guiSize.onChange((e=>{this.ripples&&(this.ripples.uniforms.size.value=e)})))}getCanvasSizes(){return this.curtains.getBoundingRect()}lerp(e,t,s){return(1-s)*e+s*t}onMouseMove(e){if(this.ripples){this.mouse.last.x=this.mouse.current.x,this.mouse.last.y=this.mouse.current.y;let t=this.ripples.mouseToPlaneCoords(this.mouse.last.x,this.mouse.last.y);this.ripples.uniforms.lastMousePosition.value=[t.x,t.y];let s=!0;0===this.mouse.last.x&&0===this.mouse.last.y&&0===this.mouse.current.x&&0===this.mouse.current.y&&(s=!1),e.targetTouches?(this.mouse.current.x=e.targetTouches[0].clientX,this.mouse.current.y=e.targetTouches[0].clientY):(this.mouse.current.x=e.clientX,this.mouse.current.y=e.clientY),t=this.ripples.mouseToPlaneCoords(this.mouse.current.x,this.mouse.current.y),this.ripples.uniforms.mousePosition.value=[t.x,t.y],s&&(this.mouse.velocity={x:(this.mouse.current.x-this.mouse.last.x)/16,y:(this.mouse.current.y-this.mouse.last.y)/16})}}setRipplesShaders(){this.ripplesVs="\n              #ifdef GL_FRAGMENT_PRECISION_HIGH\n              precision highp float;\n              #else\n              precision mediump float;\n              #endif\n      \n              // default mandatory variables\n              attribute vec3 aVertexPosition;\n              attribute vec2 aTextureCoord;\n      \n              uniform mat4 uMVMatrix;\n              uniform mat4 uPMatrix;\n      \n              // custom variables\n              varying vec3 vVertexPosition;\n              varying vec2 vTextureCoord;\n      \n              void main() {\n      \n                  vec3 vertexPosition = aVertexPosition;\n      \n                  gl_Position = uPMatrix * uMVMatrix * vec4(vertexPosition, 1.0);\n      \n                  // varyings\n                  vTextureCoord = aTextureCoord;\n                  vVertexPosition = vertexPosition;\n              }\n          ",this.ripplesFs='\n              #ifdef GL_FRAGMENT_PRECISION_HIGH\n              precision highp float;\n              #else\n              precision mediump float;\n              #endif\n      \n              uniform vec2 uResolution;\n              uniform vec2 uMousePosition;\n              uniform vec2 uLastMousePosition;\n              uniform vec2 uVelocity;\n              uniform int uTime;\n              uniform sampler2D uTargetTexture;\n              \n              uniform float uViscosity;\n              uniform float uSpeed;\n              uniform float uSize;\n              \n              varying vec3 vVertexPosition;\n              varying vec2 vTextureCoord;\n              \n              // line distance field\n              float sdLine( vec2 p, vec2 a, vec2 b ){\n                  float velocity = clamp(length(uVelocity), 0.5, 1.5);\n                  vec2 pa = p - a, ba = b - a;\n                  float h = clamp( dot(pa, ba)/dot(ba, ba), 0.0, 1.0 );\n                  return length( pa - ba*h ) / velocity;\n              }\n      \n              \n              void main() {\n                  float velocity = clamp(length(uVelocity), 0.1, 1.0);\n                  vec3 speed = vec3(vec2(uSpeed) / uResolution.xy, 0.0);\n                             \n                  vec2 mouse = (uMousePosition + 1.0) * 0.5;\n                  vec2 lastMouse = (uLastMousePosition + 1.0) * 0.5;            \n      \n                  vec4 color = texture2D(uTargetTexture, vTextureCoord);\n                  \n                  // trick given by Edan Kwan on this codepen: https://codepen.io/edankwan/pen/YzXgxxr\n                  // "It is always better to use line distance field instead of single point distance for ripple drawing. And it is cheap and simple."\n                  //float shade = smoothstep(0.02 * uSize * velocity, 0.0, length(mouse - vTextureCoord));\n                  float shade = smoothstep(0.02 * uSize * velocity, 0.0, sdLine(vTextureCoord, lastMouse, mouse));        \n              \n                  vec4 texelColor = color;\n                  \n                  float d = shade * uViscosity;\n                  \n                  float top = texture2D(uTargetTexture, vTextureCoord - speed.zy, 1.0).x;\n                  float right = texture2D(uTargetTexture, vTextureCoord - speed.xz, 1.0).x;\n                  float bottom = texture2D(uTargetTexture, vTextureCoord + speed.xz, 1.0).x;\n                  float left = texture2D(uTargetTexture, vTextureCoord + speed.zy, 1.0).x;\n                  \n                  d += -(texelColor.y - 0.5) * 2.0 + (top + right + bottom + left - 2.0);\n                  d *= 0.99;\n                  \n                  // skip first frames\n                  d *= float(uTime > 5);\n                  \n                  d = d * 0.5 + 0.5;\n                  \n                  color = vec4(d, texelColor.x, 0.0, 1.0);\n              \n                  gl_FragColor = color;\n              }\n          '}swapPasses(){var e=this.readPass;this.readPass=this.writePass,this.writePass=e,this.ripplesTexture.setFromTexture(this.readPass.textures[0])}createRipplesTexture(){return this.ripplesTexture=this.ripples.createTexture({sampler:"uTargetTexture"}),new Promise((e=>{this.ripplesTexture&&e()}))}init(){this.readPass=this.curtains.addRenderTarget({clear:!1}),this.writePass=this.curtains.addRenderTarget({clear:!1}),this.setRipplesShaders();let e=this.getCanvasSizes();this.ripplesParams={vertexShader:this.ripplesVs,fragmentShader:this.ripplesFs,autoloadSources:!1,depthTest:!1,watchScroll:!1,uniforms:{mousePosition:{name:"uMousePosition",type:"2f",value:[this.mouse.current.x,this.mouse.current.y]},lastMousePosition:{name:"uLastMousePosition",type:"2f",value:[this.mouse.current.x,this.mouse.current.y]},velocity:{name:"uVelocity",type:"2f",value:[this.mouse.velocity.x,this.mouse.velocity.y]},resolution:{name:"uResolution",type:"2f",value:[e.width,e.height]},time:{name:"uTime",type:"1i",value:-1},viscosity:{name:"uViscosity",type:"1f",value:this.params.viscosity},speed:{name:"uSpeed",type:"1f",value:this.params.speed},size:{name:"uSize",type:"1f",value:this.params.size}}},this.ripples=this.curtains.addPlane(this.params.container,this.ripplesParams),this.ripples&&(this.createRipplesTexture().then((()=>{this.params.callback&&this.params.callback(this.ripplesTexture)})),this.ripples.onReady((()=>{window.addEventListener("mousemove",(e=>this.onMouseMove(e))),window.addEventListener("touchmove",(e=>this.onMouseMove(e)))})).onRender((()=>{this.ripples.uniforms.velocity.value=[this.mouse.velocity.x,this.mouse.velocity.y],this.mouse.velocity={x:this.lerp(this.mouse.velocity.x,0,.1),y:this.lerp(this.mouse.velocity.y,0,.1)},this.ripples.uniforms.velocity.value=[this.mouse.velocity.x,this.mouse.velocity.y],this.ripples.uniforms.time.value++,this.writePass&&this.ripples.setRenderTarget(this.writePass)})).onAfterRender((()=>{this.readPass&&this.writePass&&this.swapPasses()})).onAfterResize((()=>{e=this.getCanvasSizes(),this.ripples.uniforms.resolution.value=[e.width,e.height]})))}}class t{constructor({viscosity:e=5,speed:t=3.5,size:s=1,displacementStrength:i=4,lightIntensity:n=5,shadowIntensity:o=2.5}={}){this.params={viscosity:e,speed:t,size:s,displacementStrength:i,lightIntensity:n,shadowIntensity:o},this.init()}debug(){this.sceneGui=this.gui.addFolder("Scene"),this.sceneGui.open(),this.guiDisplacement=this.sceneGui.add(this.guiParams,"displacement",0,5),this.guiLights=this.sceneGui.add(this.guiParams,"lights",.1,10),this.guiShadows=this.sceneGui.add(this.guiParams,"shadows",.1,10),this.guiBlurRipples=this.sceneGui.add(this.guiParams,"blurRipples",!0),this.guiShowTexture=this.sceneGui.add(this.guiParams,"showTexture",!0),this.guiTitleColor=this.sceneGui.addColor(this.guiParams,"titleColor"),this.guiDisplacement.onChange((e=>{this.scenePlane&&(this.scenePlane.uniforms.displacementStrength.value=e)})),this.guiLights.onChange((e=>{this.scenePlane&&(this.scenePlane.uniforms.lightIntensity.value=e)})),this.guiShadows.onChange((e=>{this.scenePlane&&(this.scenePlane.uniforms.shadowIntensity.value=e)})),this.guiBlurRipples.onChange((e=>{this.scenePlane&&(this.scenePlane.uniforms.blurRipples.value=e?1:0)})),this.guiShowTexture.onChange((e=>{this.scenePlane&&(this.scenePlane.uniforms.showTexture.value=e?1:0)})),this.guiTitleColor.onChange((e=>{this.scenePlane&&(this.scenePlane.uniforms.titleColor.value=e)}))}init(){this.curtains=new Curtains({container:"canvas",alpha:!1}).onError((()=>{document.body.classList.add("no-curtains")})).onContextLost((()=>{this.curtains.restoreContext()})),this.setSceneShaders(),this.sceneElement=document.getElementById("water-ripples"),this.guiParams={displacement:this.params.displacementStrength,lights:this.params.lightIntensity,shadows:this.params.shadowIntensity,blurRipples:!0,showTexture:!0,titleColor:[255,255,255]},this.gui=new dat.GUI,this.ripples=new e({curtains:this.curtains,container:this.sceneElement,viscosity:this.params.viscosity||null,speed:this.params.speed||null,size:this.params.size||null,callback:e=>{this.createScenePlane(e)},gui:this.gui||null,guiParams:this.guiParams||null}),this.debug()}setSceneShaders(){this.sceneVs="\n              precision highp float;\n              \n              // default mandatory variables\n              attribute vec3 aVertexPosition;\n              attribute vec2 aTextureCoord;\n              \n              uniform mat4 uMVMatrix;\n              uniform mat4 uPMatrix;\n              \n              // varyings\n              varying vec3 vVertexPosition;\n              varying vec2 vTextureCoord;\n              varying vec2 vPlaneTextureCoord;\n              \n              // textures matrices\n              uniform mat4 planeTextureMatrix;\n      \n              void main() {\n                  gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n                  \n                  // varyings\n                  vTextureCoord = aTextureCoord;\n                  vPlaneTextureCoord = (planeTextureMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;\n                  vVertexPosition = aVertexPosition;\n              }\n          ",this.sceneFs="\n              precision highp float;\n              \n              // varyings\n              varying vec3 vVertexPosition;\n              varying vec2 vTextureCoord;\n              varying vec2 vPlaneTextureCoord;\n              \n              uniform sampler2D uRippleTexture;\n              uniform sampler2D planeTexture;\n              uniform sampler2D titleTexture;\n              \n              uniform vec2 uResolution;\n              \n              uniform float uDisplacementStrength;\n              uniform float uLightIntensity;\n              uniform float uShadowIntensity;\n              \n              uniform float uBlurRipples;\n              uniform float uShowTexture;\n              uniform vec3 uTitleColor;\n              \n              \n              // Holy fuck balls, fresnel!\n              const float bias = 0.2;\n              const float scale = 10.0;\n              const float power = 10.1;\n              \n              // taken from https://github.com/Jam3/glsl-fast-gaussian-blur\n              vec4 blur5(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n                  vec4 color = vec4(0.0);\n                  vec2 off1 = vec2(1.3333333333333333) * direction;\n                  color += texture2D(image, uv) * 0.29411764705882354;\n                  color += texture2D(image, uv + (off1 / resolution)) * 0.35294117647058826;\n                  color += texture2D(image, uv - (off1 / resolution)) * 0.35294117647058826;\n                  return color;\n              }\n              \n              float bumpMap(vec2 uv, float height, inout vec3 colormap) {\n                  vec3 shade;\n                  // branching on an uniform is OK\n                  if(uBlurRipples == 1.0) {\n                      shade = blur5(uRippleTexture, vTextureCoord, uResolution, vec2(1.0, 1.0)).rgb;\n                  }\n                  else {\n                      shade = texture2D(uRippleTexture, vTextureCoord).rgb;\n                  }\n                  \n                  return 1.0 - shade.r * height;\n              }\n              \n              float bumpMap(vec2 uv, float height) {\n                  vec3 colormap;\n                  return bumpMap(uv, height, colormap);\n              }\n      \n              // add bump map, reflections and lightnings to the ripples render target texture\n              vec4 renderPass(vec2 uv, inout float distortion) {\n                  vec3 surfacePos = vec3(uv, 0.0);\n                  vec3 ray = normalize(vec3(uv, 1.0));\n      \n                  vec3 lightPos = vec3( 2.0, 3.0, -3.0);\n                  vec3 normal = vec3(0.0, 0.0, -1);\n                  \n                  vec2 sampleDistance = vec2(0.005, 0.0);\n                  \n                  vec3 colormap;\n                  \n                  float fx = bumpMap(sampleDistance.xy, 0.2);\n                  float fy = bumpMap(sampleDistance.yx, 0.2);\n                  float f = bumpMap(vec2(0.0), 0.2, colormap);\n                  \n                  distortion = f;\n                  \n                  fx = (fx - f) / sampleDistance.x;\n                  fy = (fy - f) / sampleDistance.x;\n                  normal = normalize(normal + vec3(fx, fy, 0.0) * 0.2);\n                  \n                  // Holy fuck balls, fresnel!\n                  float shade = bias + (scale * pow(1.0 + dot(normalize(surfacePos - vec3(uv, -3.0)), normal), power));\n                  \n                  vec3 lightV = lightPos - surfacePos;\n                  float lightDist = max(length(lightV), 0.001);\n                  lightV /= lightDist;\n                  \n                  // light color based on light intensity\n                  vec3 lightColor = vec3(1.0 - uLightIntensity / 20.0);\n                  \n                  float shininess = 0.1;\n                  // brightness also based on light intensity\n                  float brightness = 1.0 - uLightIntensity / 40.0;\n                  \n                  float falloff = 0.1;\n                  // finally attenuation based on light intensity as well\n                  float attenuation = (0.75 + uLightIntensity / 40.0) / (1.0 + lightDist * lightDist * falloff);\n                  \n                  float diffuse = max(dot(normal, lightV), 0.0);\n                  float specular = pow(max(dot( reflect(-lightV, normal), -ray), 0.0), 15.0) * shininess;\n                  \n                  vec3 reflect_ray = reflect(vec3(uv, 1.0), normal * 1.0);\n                  vec3 texCol = (vec3(0.5) * brightness);\n                  \n                  float metalness = (1.0 - colormap.x);\n                  metalness *= metalness;\n                  \n                  vec3 color = (texCol * (diffuse * vec3(0.9) * 2.0 + 0.5) + lightColor * specular * f * 2.0 * metalness) * attenuation * 2.0;\n      \n                  return vec4(color, 1.0);\n              }\n      \n      \n              void main() {\n                  vec4 color = vec4(1.0);\n                  \n                  float distortion;\n                  vec4 reflections = renderPass(vTextureCoord, distortion);            \n                  \n                  vec4 ripples = vec4(0.16);            \n                  ripples += distortion * 0.1 - 0.1;\n                  ripples += reflections * 0.7;\n                  \n                  \n                  vec2 textureCoords = vTextureCoord + distortion * (uDisplacementStrength / 250.0);\n                  vec2 planeTextureCoords = vPlaneTextureCoord + distortion * (uDisplacementStrength / 250.0);\n                  \n                  vec4 texture = texture2D(planeTexture, planeTextureCoords);\n                  vec4 title = texture2D(titleTexture, textureCoords);\n                  title.rgb *= vec3(uTitleColor.r / 255.0, uTitleColor.g / 255.0, uTitleColor.b / 255.0);\n                  \n                  // mix texture and title\n                  color = mix(vec4(0.05, 0.05, 0.05, 1.0), texture, uShowTexture);\n                  color = mix(color, title, title.a);\n      \n                  \n                  // add fake lights & shadows\n                  float lights = max(0.0, ripples.r - 0.5);\n                  color.rgb += lights * (uLightIntensity / 10.0);\n                  \n                  float shadow = max(0.0, 1.0 - (ripples.r + 0.5));\n                  color.rgb -= shadow * (uShadowIntensity / 10.0);\n                  \n                  gl_FragColor = color;\n              }\n          "}writeTitleCanvas(e){const t=document.getElementById("water-ripples-title").querySelector("h1"),s=window.getComputedStyle(t);let i=t.offsetTop*this.curtains.pixelRatio;i+=t.clientHeight*this.curtains.pixelRatio*.1;const n=this.scenePlane.getBoundingRect(),o=n.width,a=n.height;e.width=o,e.height=a;let r=e.getContext("2d");r.width=o,r.height=a,r.fillStyle=s.color,r.font=parseFloat(s.fontWeight)+" "+parseFloat(s.fontSize)*this.curtains.pixelRatio+"px "+s.fontFamily,r.fontStyle=s.fontStyle,r.textAlign="center",r.textBaseline="top",r.fillText(t.innerText,o/2,i),this.scenePlane.textures&&this.scenePlane.textures.length>1&&(this.scenePlane.textures[1].resize(),this.scenePlane.textures[1].needUpdate())}createScenePlane(e){let t=this.curtains.getBoundingRect();const s={vertexShader:this.sceneVs,fragmentShader:this.sceneFs,uniforms:{resolution:{name:"uResolution",type:"2f",value:[t.width,t.height]},displacementStrength:{name:"uDisplacementStrength",type:"1f",value:this.params.displacementStrength},lightIntensity:{name:"uLightIntensity",type:"1f",value:this.params.lightIntensity},shadowIntensity:{name:"uShadowIntensity",type:"1f",value:this.params.shadowIntensity},blurRipples:{name:"uBlurRipples",type:"1f",value:1},showTexture:{name:"uShowTexture",type:"1f",value:1},titleColor:{name:"uTitleColor",type:"3f",value:[255,255,255]}}};if(this.scenePlane=this.curtains.addPlane(this.sceneElement,s),this.scenePlane){const s=document.createElement("canvas");s.setAttribute("data-sampler","titleTexture"),s.style.display="none",this.scenePlane.loadCanvas(s),this.scenePlane.onLoading((e=>{e.shouldUpdate=!1,this.scenePlane.canvases&&this.scenePlane.canvases.length>0&&(document.fonts?document.fonts.ready.then((()=>{this.writeTitleCanvas(s)})):setTimeout((()=>{this.writeTitleCanvas(s)}),750))})).onReady((()=>{this.scenePlane.createTexture({sampler:"uRippleTexture",fromTexture:e})})).onAfterResize((()=>{t=this.curtains.getBoundingRect(),this.scenePlane.uniforms.resolution.value=[t.width,t.height],this.writeTitleCanvas(s)}))}}}window.addEventListener("load",(()=>{new t({viscosity:5,speed:5,size:1,displacementStrength:1.5,lightIntensity:5,shadowIntensity:2.5})}))}window.FLS=!1,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)})),t.any()?document.documentElement.classList.add("touch"):document.documentElement.classList.add("pc"),window.addEventListener("load",(function(){setTimeout((function(){document.documentElement.classList.add("loaded")}),0)})),function(){r=!0;const e=document.querySelector("header.header"),t=e.hasAttribute("data-scroll-show"),s=e.dataset.scrollShow?e.dataset.scrollShow:500,i=e.dataset.scroll?e.dataset.scroll:1;let n,o=0;document.addEventListener("windowScroll",(function(a){const r=window.scrollY;clearTimeout(n),r>=i?(!e.classList.contains("_header-scroll")&&e.classList.add("_header-scroll"),t&&(r>o?e.classList.contains("_header-show")&&e.classList.remove("_header-show"):!e.classList.contains("_header-show")&&e.classList.add("_header-show"),n=setTimeout((()=>{!e.classList.contains("_header-show")&&e.classList.add("_header-show")}),s))):(e.classList.contains("_header-scroll")&&e.classList.remove("_header-scroll"),t&&e.classList.contains("_header-show")&&e.classList.remove("_header-show")),o=r<=0?0:r}))}()})();